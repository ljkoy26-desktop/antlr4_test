тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа
эЩШъ▓╜
тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа



# 1. ьЮРы░Ф ы▓ДьаД

C:\Users\ljkoy>java -version

openjdk version "17.0.11" 2024-04-16
OpenJDK Runtime Environment Temurin-17.0.11+9 (build 17.0.11+9)
OpenJDK 64-Bit Server VM Temurin-17.0.11+9 (build 17.0.11+9, mixed mode, sharing)






тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа
vcpkg ьДдь╣Ш
тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа


# ьзЬьЮШэХЬ ьДдыкЕ ьЧЖьЭ┤. ъ░ДыЮ╡эХШъ▓М ьаХыжмэХйыЛИыЛд.


# vcpkg ыЛдьЪ┤ыбЬыУЬ

cd C:\Users\ljkoy\Desktop\Github_clone\antlr4_test
git clone https://github.com/microsoft/vcpkg.git

# ы╢АэК╕ьКдэК╕ыЮй ьЛдэЦЙ

cd vcpkg
.\bootstrap-vcpkg.bat






## 2. SqlParserLib эФДыбЬьаЭэК╕ ьДдьаХ эЩХьЭ╕ (тЪая╕П ьдСьЪФ)

**Visual Studio ьДдьаХ ъ▓╜ыбЬ:**
`эФДыбЬьаЭэК╕` тЖТ `ьЖНьД▒` тЖТ `ъ╡мьД▒ ьЖНьД▒` тЖТ `C/C++` тЖТ `ь╜ФыУЬ ьГЭьД▒(Code Generation)` тЖТ `ыЯ░эГАьЮД ыЭ╝ьЭ┤ы╕МыЯмыжм(Runtime Library)`

### ыЯ░эГАьЮД ыЭ╝ьЭ┤ы╕МыЯмыжм ьДдьаХ ы╣Дъ╡РэСЬ
# эШДьЮм SqlParserLib эФДыбЬьаЭэК╕ыКФ /MDd ы░йьЛЭ ь▒ДэГЭьдС

| **ыЛдьдС ьКдыаИыУЬ DLL (/MD, /MDd)** | MFC ъ╕░ы│╕ъ░Т. DLL ъ│╡ьЬа ьВмьЪй     | `x64-windows` (ыШРыКФ `x86-windows`) |
| **ыЛдьдС ьКдыаИыУЬ (/MT, /MTd)**     | Static Link. ьЛдэЦЙ эММьЭ╝ьЧР эПмэХи | `x64-windows-static` |



#### Case A: эФДыбЬьаЭэК╕ъ░А /MD (DLL) ьДдьаХьЭ╕ ъ▓╜ьЪ░ (ъ╢МьЮе) ( ыЕ╕эК╕ы╢БьЧРьДЬ ьЛдэЦЙ ьЛЬ, ьЛЬъ░Д ыздьЪ░ ьШдыЮШъ▒╕ыа╕ьЭМ )

.\vcpkg install antlr4:x64-windows


#### Case B: эФДыбЬьаЭэК╕ъ░А /MT (Static) ьДдьаХьЭ╕ ъ▓╜ьЪ░

.\vcpkg install antlr4:x64-windows-static



### 3.2 Visual Studio эЖ╡эХй (Integrate)
# Visual Studioъ░А ьДдь╣ШыРЬ ыЭ╝ьЭ┤ы╕МыЯмыжмые╝ ьЮРыПЩьЬ╝ыбЬ ьЭ╕ьЛЭэХШыПДыбЭ ьЧ░ъ▓░эХйыЛИыЛд. (ь╡Ьь┤И 1эЪМызМ ьИШэЦЙ)

.\vcpkg integrate install


**ьД▒ъ│╡ ыйФьЛЬьзА:**
# Applied user-wide integration for this vcpkg root.











### 4.1 SQLParserLib MFC эФДыбЬьаЭэК╕ эПмэХи ыФФыаЙэД░ыжм ьДдьаХ (Include Path)
# `эФДыбЬьаЭэК╕ ьЖНьД▒` тЖТ `C/C++` тЖТ `ьЭ╝ы░Ш` тЖТ `ь╢Фъ░А эПмэХи ыФФыаЙэД░ыжм`

[vcpkgьДдь╣Шъ▓╜ыбЬ]\installed\x64-windows\include\antlr4-runtime
ьШИ) $(SolutionDir)vcpkg\installed\x64-windows\include\antlr4-runtime



### 4.2 C++ ьЦ╕ьЦ┤ эСЬьдА ьДдьаХ
# эФДыбЬьаЭэК╕ ьЖНьД▒` тЖТ `C/C++` тЖТ `ьЦ╕ьЦ┤` тЖТ `C++ ьЦ╕ьЦ┤ эСЬьдА`

**ъ░Т ы│Аъ▓╜:**
 ISO C++17 эСЬьдА(/std:c++17)


 
### 4.3 Windows ыздэБмыбЬ ь╢йыПМ эХ┤ъ▓░ (ь╜ФыУЬ ьИШьаХ)

Windows/MFCьЭШ `min`, `max`, `ERROR` ыздэБмыбЬъ░А ANTLRьЩА ь╢йыПМэХШыпАыбЬ, ANTLR эЧдыНФые╝ эПмэХиэХШъ╕░ ьаДьЧР ы░ШыУЬьЛЬ эХ┤ьаЬэХ┤ьХ╝ эХйыЛИыЛд.

**ьВмьЪй ьШИьЛЬ (Dlg.cpp ыШРыКФ Proxy Header):**

# cpp ьЧР ь╢Фъ░А 

#include "pch.h"

# ... MFC ъ┤Аыаи эЧдыНФыУд ...
# [ьдСьЪФ] ANTLR эЧдыНФ эПмэХи ьаД ыздэБмыбЬ эХ┤ьаЬ

#undef min
#undef max
#undef ERROR
#undef NO_ERROR

#include <antlr4-runtime.h>  // ыШРыКФ <antlr4-runtime/antlr4-runtime.h>


тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа
Grammer ые╝ ьВмьЪйэХШьЧм cpp, h эММьЭ╝ ьГЭьД▒
тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа

# 3. grammer.f4 эММьЭ╝ ыЛдьЪ┤ыбЬыУЬ 

LexerьЩА Parser ыСШ ыЛд эХДьЪФэХйыЛИыЛд: 
ыМАы╢Аы╢ДьЭШ SQL ым╕ы▓ХьЭА эММьЭ╝ьЭ┤ ыСР ъ░Ь(xxxLexer.g4, xxxParser.g4)ыбЬ ыВШыЙШьЦ┤ ьЮИьК╡ыЛИыЛд.
эХШыВШызМ ьЮИьЬ╝ый┤ ьХИ ыРШыЛИ ъ╝н ыСР эММьЭ╝ ыкиыСР ыЛдьЪ┤ыбЬыУЬэХШьД╕ьЪФ.


Oracle (PL/SQL) ЁЯСЙ https://github.com/antlr/grammars-v4/tree/master/sql/plsql

ыЛдьЪ┤ыбЬыУЬ ыМАьГБ: PlSqlLexer.g4, PlSqlParser.g4 (ыСШ ыЛд ы░ЫьЬ╝ьД╕ьЪФ)

MS SQL Server (T-SQL) ЁЯСЙ https://github.com/antlr/grammars-v4/tree/master/sql/tsql

ыЛдьЪ┤ыбЬыУЬ ыМАьГБ: TSqlLexer.g4, TSqlParser.g4

MySQL ЁЯСЙ https://github.com/antlr/grammars-v4/tree/master/sql/mysql


ьг╝ьЭШ: ьЭ┤ эП┤ыНФ ьХИьЧР ыУдьЦ┤ъ░Аый┤ Oracle ы▓ДьаДъ│╝ Positive-Technologies ы▓ДьаД эП┤ыНФъ░А ыШР ьЮИьК╡ыЛИыЛд. ы│┤эЖ╡ Oracle эП┤ыНФ ьХИьЧР ьЮИыКФ ъ▓ГьЭ┤ ъ│╡ьЛЭьЧР ъ░Аъ╣ЭьК╡ыЛИыЛд.

https://github.com/antlr/grammars-v4/tree/master/sql/mysql/Oracle


PostgreSQL ЁЯСЙ https://github.com/antlr/grammars-v4/tree/master/sql/postgresql

ыЛдьЪ┤ыбЬыУЬ ыМАьГБ: PostgreSQLLexer.g4, PostgreSQLParser.g4




 
# 4. grammer.g4 эММьЭ╝ьЭД ьЭ┤ьЪйэХЬ ы╣МыУЬ 



DB ьвЕыеШ,ьзАьЫР ьЧмы╢А,ьВмьЪйэХа эММьЭ╝ (.g4),ьДдыкЕ

Oracle,     тЬЕ ьЩДы▓╜,    plsql,ъ░АьЮе эЩЬы░ЬэЮИ ъ┤АыжмыРи. ъ▒░ьЭШ ьЩДы▓╜ ьзАьЫР.
SQL Server, тЬЕ ьЩДы▓╜,    tsql,Microsoft T-SQL ым╕ы▓Х. ыздьЪ░ ьЮШ ыРШьЦ┤ ьЮИьЭМ.
MySQL,      тЬЕ ьЩДы▓╜,    mysql,Oracle MySQL ы▓ДьаД ъ╕░ьдА.
PostgreSQL, тЬЕ ьЩДы▓╜,    postgresql,ыздьЪ░ ьГБьД╕эХШъ▓М ъ╡мэШДыРШьЦ┤ ьЮИьЭМ.
Tibero,     тЪая╕П ыМАь▓┤,    plsql (Oracle),эЛ░ы▓аыбЬыКФ ьШдыЭ╝эБ┤ эШ╕эЩШьД▒ьЭ┤ ыкйэСЬьЭ╕ DBыЭ╝ plsql ым╕ы▓ХьЭД ьУ░ый┤ 95% ьЭ┤ьГБ эММьЛ▒ыРйыЛИыЛд.
Sybase ASE, тЪая╕П ыМАь▓┤,    tsql (MSSQL),SybaseьЩА MSSQLьЭА ы┐Мыжмъ░А ъ░ЩьК╡ыЛИыЛд. tsql ым╕ы▓ХьЭД ьУ░ый┤ ыМАы╢Аы╢Д эШ╕эЩШыРйыЛИыЛд.
Vertica,    тЪая╕П ыМАь▓┤,    postgresql,VerticaыКФ эПмьКдэК╕ъ╖╕ыаИ ъ╕░ы░ШьЮЕыЛИыЛд. postgresql ым╕ы▓ХьЭД ьИШьаХэХ┤ьДЬ ьНиьХ╝ эХйыЛИыЛд.
Sybase IQ,  тЭМ ьЧЖьЭМ,    tsql + ьИШьаХ,ASEьЩА ыЛмыжм ы╢ДьДЭэШХьЭ┤ыЭ╝ ым╕ы▓ХьЭ┤ ьб░ъ╕И ыЛдыжЕыЛИыЛд. tsqlьЭД ъ╕░ы░ШьЬ╝ыбЬ ьИШьаХьЭ┤ эХДьЪФэХйыЛИыЛд.
DB2,        тЭМ ьЧЖьЭМ,    (ьзБьаС ъ╡мэШД),ьЭШьЩ╕ыбЬ ъ│╡ъ░ЬыРЬ ьЩДы▓╜эХЬ ANTLR4 ым╕ы▓ХьЭ┤ ьЧЖьК╡ыЛИыЛд. (ы╢Аы╢ДьаБьЭ╕ ьЮРыгМызМ ьб┤ьЮм)
Altibase,   тЭМ ьЧЖьЭМ,    (ьзБьаС ъ╡мэШД),ъ╡ньВ░ DBыЭ╝ эХ┤ьЩ╕ ыжмэПмьзАэЖаыжмьЧР ьЧЖьК╡ыЛИыЛд. эСЬьдА SQL ым╕ы▓ХьЭД ъ╕░ы░ШьЬ╝ыбЬ ызМыУдьЦ┤ьХ╝ эХйыЛИыЛд.



# ьЭ╝ъ┤Д ьГЭьД▒ ьШИьаЬь╜ФыУЬ 

cd H:\Source\GithubDesktop\antlr4_test\Grammer
h:

C:\Users\ljkoy\Desktop\Github_clone\antlr4_test\Grammer

java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o oracle_gen PlSqlLexer.g4
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o oracle_gen PlSqlParser.g4

		  
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o sqlserver_gen TSqlLexer.g4
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o sqlserver_gen TSqlParser.g4
		  		  
		  
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o mysql_gen MySQLLexer.g4
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o mysql_gen MySQLParser.g4
		  
		  
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o postgres_gen PostgreSQLLexer.g4
java -jar antlr-4.13.2-complete.jar -Dlanguage=Cpp -package antlrcpptest -no-listener -visitor -o postgres_gen PostgreSQLParser.g4






тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа
SQLParserLib ы╣МыУЬ , ыйФьЭ╕ MFC ыМАэЩФьГБьЮР эФДыбЬьаЭэК╕ ьДдьаХ
тЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦатЦа


# 2. ъ╡мэШД ъ░АьЭ┤ыУЬ (Step-by-Step)


1ыЛиъ│Д: эММьДЬ ьаДьЪй эФДыбЬьаЭэК╕ ( SQLParserLib ) ызМыУдъ╕░

- ъ╡мьД▒ьЖНьД▒ -> ьЭ╝ы░Ш -> ъ╡мьД▒ эШХьЛЭ ( ьаХьаБ ыЭ╝ьЭ┤ы╕МыЯмыжм(.lib) ) 
- ъ╡мьД▒ьЖНьД▒ -> ьЭ╝ы░Ш -> C++ ьЦ╕ьЦ┤эСЬьдА ( C++ 17 )
- C/C++ -> ып╕ыжм ь╗┤эММьЭ╝ыРЬ эЧдыНФ -> ып╕ыжм ь╗┤эММьЭ╝ыРЬ эЧдыНФ ( ь▓┤эБм эХ┤ьаЬ )
- C/C++ -> ь╜ФыУЬ ьГЭьД▒ -> ыЛдьдС ьКдыаИыУЬ ыФФы▓Дъ╖╕ DLL(/MDd) , ыЛдьдС ьКдыаИыУЬ DLL(/MD)
- C/C++ -> ьЭ╝ы░Ш -> ь╢Фъ░А эПмэХи ыФФыаЙэД░ыжм

# ьХДыЮШ ьЮШ ь░╕ъ│аэХ┤ьДЬ ь╢Фъ░А эХШьД╕ьЪФ

# тЪая╕П ьдСьЪФ ьШ╡ьЕШ ь╢Фъ░А: PL/SQL эММьДЬъ░А ыДИым┤ ь╗дьДЬ ь╗┤эММьЭ╝ыЯмъ░А ы╗ЧьЭД ьИШ ьЮИьК╡ыЛИыЛд.
C/C++ -> ыкЕыа╣ьдД(Command Line) -> ь╢Фъ░А ьШ╡ьЕШьЧР ьХДыЮШ ьЮЕыае   (ьЭ┤ъ▒░ ьХИ эХШый┤ C1128 ьЧРыЯм ыВи)
/bigobj


<AdditionalIncludeDirectories>
$(ProjectDir)Source\Oracle;
$(ProjectDir)Source\SQLServer;
$(ProjectDir)Source\MySQL;
$(ProjectDir)Source\PostgreSQL;
$(SolutionDir)vcpkg\installed\x64-windows\include\antlr4-runtime
</AdditionalIncludeDirectories>

2ыЛиъ│Д: ьГЭьД▒ыРЬ эММьЭ╝ ьШоъ╕░ъ╕░

1ыЛиъ│Д ьЧРьДЬ ьДдьаХэХЬ эММьЭ╝ыУд ( (Oracle, TSQL, MySQL, PG)ьЭШ .h, .cpp эММьЭ╝ыУд ) 
ык╜ыХЕ SqlParserLib эФДыбЬьаЭэК╕ эП┤ыНФыбЬ ьШоъ╕░ъ│а ь╢Фъ░АэХйыЛИыЛд.









